from pathlib import Path

from pywintypes import IID

from koapy.utils.pywin32 import GetLatestTypelibSpec, GetTypelibSpecs

CPFOREDIB_CLSID = IID("{ABA39D6F-5AF4-4D10-8389-031055C13A75}")
CPFORETRADE_CLSID = IID("{1E3BC2CB-4AC7-46BB-AF63-11DEA8628E3C}")

CPSYSDIB_CLSID = IID("{9C31B76A-7189-49A3-9781-3C6DD6ED5AD3}")
CPTRADE_CLSID = IID("{1F7D5E5A-05AB-4236-B6F3-3D383B09203A}")

CPUTIL_CLSID = IID("{2DA9C35C-FE59-4A32-A942-325EE8A6F659}")
DSCBO1_CLSID = IID("{859343F1-08FD-11D4-8231-00105A7C4F8C}")

CPUTIL_TYPELIB_SPECS = GetTypelibSpecs(CPUTIL_CLSID)
CPUTIL_TYPELIB_SPEC = GetLatestTypelibSpec(CPUTIL_TYPELIB_SPECS)

CPUTIL_TYPELIB_DLL_PATH = (
    CPUTIL_TYPELIB_SPEC and CPUTIL_TYPELIB_SPEC.dll and Path(CPUTIL_TYPELIB_SPEC.dll)
)

INSTALLATION_PATH_FROM_DEFAULT_INSTALLATION = Path("C:\\DAISHIN")
INSTALLATION_PATH_FROM_TYPELIB_DLL = (
    CPUTIL_TYPELIB_DLL_PATH and CPUTIL_TYPELIB_DLL_PATH.parent.parent
)
INSTALLATION_PATH = (
    INSTALLATION_PATH_FROM_TYPELIB_DLL or INSTALLATION_PATH_FROM_DEFAULT_INSTALLATION
)
